<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

	<p:dialog header="#{msg['bug.update']}" widgetVar="bugUpdateDialog"
		resizable="false" modal="true" showEffect="clip" hideEffect="fold"
		height="600" width="600">

		<h:form id="formBugEdit">

			<h:panelGrid columns="2" cellpadding="5" id="display">
				<p:outputLabel value="#{msg['bug.title']}" />
				<p:inputText id="title" required="true"
					requiredMessage="#{msg['error.emptytitle']}"
					value="#{bugBean.selectedBug.title}"></p:inputText>
				<p:message for="title" />


				<p:outputLabel value="#{msg['bug.description']}" />
				<p:inputText id="description" required="true"
					requiredMessage="#{msg['error.emptydescription']}"
					value="#{bugBean.selectedBug.description}"></p:inputText>
				<p:message for="description" />

				<p:outputLabel value="#{msg['bug.targetDate']}"></p:outputLabel>
				<p:calendar value="#{bugBean.selectedBug.targetDate}" />

				<p:outputLabel value="#{msg['bug.severity']}"></p:outputLabel>

				<p:selectOneMenu value="#{bugBean.selectedBug.severity}"
					style="width:90px">

					<f:selectItems value="#{bugBean.severityList}" var="severities"
						itemLabel="#{msg['bug.severity.' += severities]}" />

				</p:selectOneMenu>

				<p:outputLabel value="#{msg['bug.status']}"></p:outputLabel>
				<p:selectOneMenu value="#{bugBean.selectedBug.status}"
					converter="#{bugConverter}" style="width:90px">

					<f:selectItems value="#{bugBean.getStatusList()}" var="status"
						itemLabel="#{status}" itemValue="#{status}" />

				</p:selectOneMenu>

				<p:outputLabel value="#{msg['bug.assigned']}"></p:outputLabel>
				<f:view>
					<p:autoComplete value="#{bugBean.selectedBug.assigned}"
						completeMethod="#{userListBean.complete}" var="user"
						itemLabel="#{user.username}" itemValue="#{user}"
						converter="#{userConverter}" forceSelection="true">
					</p:autoComplete>
				</f:view>

				<p:outputLabel value="#{msg['bug.version']}" />
				<p:inputText value="#{bugBean.selectedBug.version}"></p:inputText>

				<p:outputLabel value="#{msg['bug.fixedIn']}" />
				<p:inputText value="#{bugBean.selectedBug.fixedIn}"></p:inputText>

				<p:outputLabel value="#{msg['bug.attachment']}" />

				<h:panelGroup id="uploadGrid">
					<p:outputLabel value="#{bugBean.selectedBug.attachmentName}"
						rendered="#{not empty bugBean.selectedBug.attachment}" ajax="true" />

					<p:commandLink actionListener="#{bugBean.deleteAttachment}"
						styleClass="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-button-text ui-c" 
						action="#{bugBean.editBug}"
						rendered="#{not empty bugBean.selectedBug.attachment}"
						update="uploadFile, uploadGrid">
						<h:outputText value="#{msg['bug.attachment.delete']}" />
					</p:commandLink>

					<p:fileUpload id="uploadFile"
						fileUploadListener="#{bugBean.handleFileEdit}"
						dragDropSupport="false" sizeLimit="26214400"
						update="@this, attachmentUploded" fileLimit="1"
						disabled="#{not empty bugBean.selectedBug.attachment}"
						allowTypes="/(\.|\/)(gif|jpe?g|png|pdf|doc|xlsx|xls|odf)$/"
						value="#{bugBean.selectedBug.attachment}" />

					<h:panelGrid id="attachmentUploded">
						<p:outputLabel value="#{msg['bug.attachment.updoded']}"
							rendered="#{not empty bugBean.selectedBug.attachment}" />
					</h:panelGrid>

					<h:commandButton value="#{msg['bug.update']}"
						action="#{bugBean.editBug}"></h:commandButton>
				</h:panelGroup>
			</h:panelGrid>

		</h:form>

	</p:dialog>

</ui:composition>